<meta charset="UTF-8">
<div id="addDataDialog" class="easyui-dialog" 
    style="width:50%;height:80%;padding:10px 20px"
    data-options="closed:true, modal:true, buttons:'#dlg-buttons' ">
           填写[楼盘图片]信息<hr/>
       <form id="dataForm" class="easyui-form" action="${siteConfig.baseURL}/configmgr/estate/${estate.id}/photo.json" method="post" enctype="multipart/form-data">
            <input id="_method" name="_method" type="hidden" />
           <input name="id" type="hidden"/>
           <input name="estateId" type="hidden" value="${photo.estateId}"/>
           <table cellpadding="5">
                <tr>
                    <td>图片类型:</td>
                    <td>
                        <input class="formFieldClass" name="photoType" id="photoType" />
                               
                    </td>
                </tr>
                <tr>
                    <td>标题:</td>
                    <td>
                        <input class="formFieldClass  easyui-text" name="title"/>
                               
                    </td>
                </tr>
                
                <tr id="unitTR" style="display: none">
                   <td>所属户型ID:</td>
                    <td>
                        <input class="easyui-combobox formFieldClass" type="text" name="unitId" id="unitId" 
                               data-options="required:false, 
                                            method:'get',
                                            url: '/configmgr/estateUnit/combobox/${estate.id}.json' "/>
                    </td>
               </tr>
               
                <tr>
                    <td>选择文件:</td>
                    <td>
                        <input class="easyui-filebox formFieldClass" type="text" name="photos[0].file" 
                               data-options="required:true,
                                             editable:false "/>
                    </td>
                    
                    <td><input class="" name="photos[0].mainPhoto" type="checkbox"/>主题图片</td>
                </tr>
               
           </table>
           <@security.csrfInput/>
       </form>
</div>

<div id="dlg-buttons">
    <a href="#" class="easyui-linkbutton" iconCls="icon-ok" onclick="saveData();">保存</a>
    <a href="#" class="easyui-linkbutton" iconCls="icon-cancel" onclick="cancel();">取消</a>
</div>
<script type="text/javascript">

	$('#photoType').combobox({
	    delay: 500,
	    //url: '${siteConfig.baseURL}/configmgr/estate/combobox.json',
	    required:true,
	    method: 'get',
	    editable: false,
	    url: '${siteConfig.baseURL}/configmgr/dictionary/combobox/ESTATE_PHOTO_TYPE.json',
	    onChange: function(newValue, oldValue){
	    	if(newValue=='FLOOR_PLAN'){
	            var url = '/configmgr/estateUnit/combobox/${estate.id}.json';
	            $('#unitTR').show();
	    	}else{
	    		$('#unitTR').hide();
	    	}
	    }
	});

    $('#addDataDialog').dialog({
        width:'50%',
        height:'80%',
        onClose: function(){
            $('#dataForm').form('reset');
        }
    })
    
    function saveData(){
        helper.submitEasyForm({dataForm: '#dataForm',dataDialog: '#addDataDialog', datagrid: '#dataGrid'});
    }
    function cancel(){
        $('#addDataDialog').dialog('close');
    }
</script>